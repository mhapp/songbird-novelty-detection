function mmNet_new = mmIter_v1(mmNet_old, cdNet, ts_idx)mmNet_new = mmNet_old;% get inputthisInput = mmNet_old.input(:, ts_idx);thisCDAct = cdNet.totalActMat(:, ts_idx);% calculate MMthisMM = (mmNet_old.w_PD_MN * thisInput) + (mmNet_old.w_CD_MN * thisCDAct);nActiv = thisMM;nActiv(nActiv<mmNet_old.mmThresh) = 0;totalMM = sum(nActiv(:));mmNet_new.totalMMMat(:, ts_idx) = thisMM;mmNet_new.totalSigMat(ts_idx) = totalMM;